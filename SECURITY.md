# 安全政策

## 安全漏洞报告

如果您发现安全漏洞，**请不要公开报告 Issue**。

### 报告流程

1. **发送邮件** 至：`security@geofence-updater-lite.org`
2. 等待确认（通常 48 小时内）
3. 按指引修复或公开

### 报告内容

请包含以下信息：

- 漏洞描述
- 影响范围
- 受影响的版本
- 复现步骤
- 建议的修复方案

## 安全设计

本项目采用纵深防御策略：

### 1. 密码学安全

- **Ed25519 签名算法**
- **离线验签** - 不依赖网络环境
- **KeyID 机制** - 支持密钥轮换

### 2. 数据完整性

- **SHA-256 哈希** - 验证数据未被篡改
- **Merkle Tree** - 验证数据一致性
- **多重验证** - 签名验证 + 哈希验证

### 3. 传输安全

- **HTTPS** - 生产环境强制 TLS
- **证书锁定** - 验证 CDN 证书
- **哈希校验** - 下载后验证文件哈希

## 密钥管理

### 私钥保护

- **存储**：建议使用硬件安全模块 (HSM)
- **备份**：离线备份并加密
- **轮换**：定期更新签名密钥
- **销毁**：旧密钥安全销毁

### 公钥分发

- **分发方式**：
  - 编译时嵌入（无人机出厂时）
  - 配置文件
  - Key ID 查询服务（可选）

### 密钥轮换

当需要更新公钥时：

1. 生成新密钥对
2. 更新配置
3. 使用 `KeyID` 机制支持多密钥并存
4. 逐步迁移

## 版本管理

### 版本号规则

版本号为递增的整数。版本 `v1025` 比 `v1024` 新。

### 向后兼容

- 客户端支持版本协商
- 低版本客户端可使用增量包升级
- 重大版本变更会明确标注 `MinClientVersion`

### 回滚保护

- 客户端拒绝应用旧版本数据
- 版本只能递增，不可递减
- 支持紧急回滚的 `MinClientV` 字段

## 已知问题与缓解措施

| 风险 | 缓解措施 | 状态 |
|------|----------|------|
| 伪造签名 | 离线验签 | ✅ |
| 重放攻击 | 版本回滚保护 | ✅ |
| 中间人攻击 | 签名验证 | ✅ |
| 恶意软件 | 多重验证 | ✅ |
| 时间攻击 | 时间戳验证 | ✅ |

---

**本项目承诺安全更新，并及时响应安全报告。**
